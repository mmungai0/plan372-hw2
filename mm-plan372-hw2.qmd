---
title: "mm-plan372-hw2"
author: "Mary Mungai"
format: html
editor: visual
---

Collect packages

```{r}
library(tidyverse) #i always have to click 'tidyverse' in packages to get it
library(lubridate)
library(ggplot2)
library(ggthemes)

```

Read CSV files

```{r}
install.packages("here")
data=read.csv(here::here("restaurant_inspections.csv")) #here:here requires that the csv file is actually in your current working directly (plan372-hw2)

```

#1 Visualize the overall distribution of inspection scores with a histogram

Check for missing data

```{r}
data |>
  summarize(na_count=sum(is.na(count)))
#No missing data

```

```{r}
ggplot(data, aes(x=SCORE)) + geom_histogram(color='white', fill='pink')

```

#2 Some restaurants have been in business much longer than others. Is there any trend in terms of how highly older vs. newer restaurants score on their inspections?

What is "old" v "new"? Making the dates mdy_hm actual dates and not characters
```{r}
data$open_date = ymd_hms(data$RESTAURANTOPENDATE) 
#I have to individually run library(lubridate) again in order for this to run
```

Check for NA vars (got a failed to parse error before)
```{r}
which(is.na(data$open_date)) #stack overflow assist; many NAs
```

Multiple restaurants can open within the same year so I grouped them together below to make the graph look nicer, then found the mean scores of restaurants which opened within the same year. 
```{r}
data_ro = data |>
  mutate(year_opened = year(open_date)) |> #works like hour lubridate function
  group_by(year_opened)|>
  summarize(mean_score = mean(SCORE, na.rm=T)) |>
  ungroup()

ggplot(data_ro, aes(x=year_opened, y=mean_score)) + geom_line()
#NOTE: One row contains missing values 
```
There doesn't seem to be much of a trend between older and newer restaurants, only sharp drops in the mean scores of some restaurants (i.e. those that opened between 1990 and 1995) and peaks in others (i.e. those who opened after 2020).


#3. Wake County is the most populous county in North Carolina, and there are many cities in it. Do the inspection scores vary by city? 

Note that the city column contains some differently spelled city names; make sure to clean those up so that there is only one estimated value per city. 

The recode function that we used for creating a weekend/weekday variable in the SFpark exercise will be useful here, and you may also be interested in the str_to_upper function.

Step 1: find and recode unique city names 
```{r}
unique(data$CITY) #ran this again after recoding 

data$CITY = recode(data$CITY, "Raleigh"="RALEIGH", "Zebulon"="ZEBULON", "Wake Forest"="WAKE FOREST", "NORTH CAROLINA" = "UNKNOWN", "Fuquay-Varina" = "FUQUAY VARINA", "Fuquay Varina" = "FUQUAY VARINA", "FUQUAY-VARINA" = "FUQUAY VARINA", "Garner" = "GARNER", "RTP" = "RESEARCH TRIANGLE PARK", "Cary" = "CARY", "Apex" = "APEX", "Morrisville" = "MORRISVILLE", "Holly Springs" = "HOLLY SPRINGS", "HOLLY SPRING" = "HOLLY SPRINGS")
```
Step 2: Group data by city 
```{r}

data_city = data |>
  group_by(CITY) |>
  summarize(mean_score = mean(SCORE, na.rm=T)) |>
  ungroup()
data_city
```
It varies a little by city but not much. It also varied by about the same amount by year opened too, with variation being between 94 and 100 for the score.

How do I graph this?

```{r}
```

```{r}


```


```{r}


```